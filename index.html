// Falling flowers animation
const canvas = document.getElementById('flowers-canvas');
const ctx = canvas.getContext('2d');
let petals = [];

function randomColor() {
  // Soft pinks, purple, yellow
  const colors = ['#ffb6c1', '#ffd1dc', '#fff7ae', '#e0bbff', '#ffecb3', '#fbc2eb'];
  return colors[Math.floor(Math.random() * colors.length)];
}

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

function createPetal() {
  const size = Math.random() * 0.7 + 0.4;
  return {
    x: Math.random() * canvas.width,
    y: -20,
    size: size * 18 + 12,
    speed: Math.random() * 1.5 + 1,
    angle: Math.random() * Math.PI * 2,
    angleSpeed: (Math.random() - 0.5) * 0.03,
    sway: Math.random() * 2 + 1,
    swaySpeed: Math.random() * 0.04 + 0.01,
    swayPhase: Math.random() * Math.PI * 2,
    color: randomColor()
  };
}

function animatePetals() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (petals.length < 30) {
    petals.push(createPetal());
  }
  for (let i = 0; i < petals.length; i++) {
    let p = petals[i];
    p.y += p.speed;
    p.angle += p.angleSpeed;
    p.x += Math.sin(p.swayPhase + p.y * p.swaySpeed) * p.sway;
    drawPetal(ctx, p.x, p.y, p.size / 20, p.angle, p.color);
    if (p.y > canvas.height + 20) {
      petals[i] = createPetal();
      petals[i].y = -20;
    }
  }
  requestAnimationFrame(animatePetals);
}
animatePetals();

// Countdown logic
const now = new Date();
const year = now.getFullYear();
const targetDate = new Date(`${year}-10-19T23:59:59`);

function updateCountdown() {
  const current = new Date();
  const diff = targetDate - current;
  const countdown = document.getElementById("countdown");
  const message = document.getElementById("message");

  if (diff > 0) {
    // Countdown is ongoing
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const minutes = Math.floor((diff / (1000 * 60)) % 60);
    const seconds = Math.floor((diff / 1000) % 60);

    countdown.innerHTML = `
      <div class="time-section">
        <div class="time">${days}</div>
        <div class="label">Days</div>
      </div>
      <div class="time-section">
        <div class="time">${hours}</div>
        <div class="label">Hours</div>
      </div>
      <div class="time-section">
        <div class="time">${minutes}</div>
        <div class="label">Minutes</div>
      </div>
      <div class="time-section">
        <div class="time">${seconds}</div>
        <div class="label">Seconds</div>
      </div>
    `;
    message.innerHTML = "";
  } else {
    // Countdown is over, show "The day"
    countdown.innerHTML = `<span class="celebrate">The Day ðŸŽ‰</span>`;
    message.innerHTML = `<div style="font-size:1.1em; margin-top:15px;">The wait is over. Enjoy your special moment!</div>`;
    clearInterval(timer);
  }
}

updateCountdown(); // Initial call
const timer = setInterval(updateCountdown, 1000); // Update every second
